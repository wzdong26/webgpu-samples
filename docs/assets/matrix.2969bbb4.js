function d(r){let n=!1;return()=>{if(n)return;n=!0;const v=requestAnimationFrame(function(i){e(),n=!1,r(i)}),e=()=>cancelAnimationFrame(v);return e}}function H(r){let n=!1;const v=d(function(e){n||(r(e),v())});return v(),()=>{n=!0}}const J=new Float32Array([1,-1,1,1,1,-1,-1,1,0,1,-1,-1,-1,0,0,1,-1,-1,1,0,1,-1,1,1,1,-1,-1,-1,0,0,1,1,1,1,1,1,-1,1,0,1,1,-1,-1,0,0,1,1,-1,1,0,1,1,1,1,1,1,-1,-1,0,0,-1,1,1,1,1,1,1,1,0,1,1,1,-1,0,0,-1,1,-1,1,0,-1,1,1,1,1,1,1,-1,0,0,-1,-1,1,1,1,-1,1,1,0,1,-1,1,-1,0,0,-1,-1,-1,1,0,-1,-1,1,1,1,-1,1,-1,0,0,1,1,1,1,1,-1,1,1,0,1,-1,-1,1,0,0,-1,-1,1,0,0,1,-1,1,1,0,1,1,1,1,1,1,-1,-1,1,1,-1,-1,-1,0,1,-1,1,-1,0,0,1,1,-1,1,0,1,-1,-1,1,1,-1,1,-1,0,0]),K=36,Q=3,U=2;var R=1e-6,j=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,n=arguments.length;n--;)r+=arguments[n]*arguments[n];return Math.sqrt(r)});function I(){var r=new j(16);return j!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function E(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function S(r,n,v){var e=n[0],i=n[1],a=n[2],s=n[3],c=n[4],f=n[5],x=n[6],l=n[7],y=n[8],h=n[9],M=n[10],A=n[11],F=n[12],w=n[13],V=n[14],P=n[15],m=v[0],p=v[1],z=v[2],g=v[3];return r[0]=m*e+p*c+z*y+g*F,r[1]=m*i+p*f+z*h+g*w,r[2]=m*a+p*x+z*M+g*V,r[3]=m*s+p*l+z*A+g*P,m=v[4],p=v[5],z=v[6],g=v[7],r[4]=m*e+p*c+z*y+g*F,r[5]=m*i+p*f+z*h+g*w,r[6]=m*a+p*x+z*M+g*V,r[7]=m*s+p*l+z*A+g*P,m=v[8],p=v[9],z=v[10],g=v[11],r[8]=m*e+p*c+z*y+g*F,r[9]=m*i+p*f+z*h+g*w,r[10]=m*a+p*x+z*M+g*V,r[11]=m*s+p*l+z*A+g*P,m=v[12],p=v[13],z=v[14],g=v[15],r[12]=m*e+p*c+z*y+g*F,r[13]=m*i+p*f+z*h+g*w,r[14]=m*a+p*x+z*M+g*V,r[15]=m*s+p*l+z*A+g*P,r}function Y(r,n,v){var e=v[0],i=v[1],a=v[2],s,c,f,x,l,y,h,M,A,F,w,V;return n===r?(r[12]=n[0]*e+n[4]*i+n[8]*a+n[12],r[13]=n[1]*e+n[5]*i+n[9]*a+n[13],r[14]=n[2]*e+n[6]*i+n[10]*a+n[14],r[15]=n[3]*e+n[7]*i+n[11]*a+n[15]):(s=n[0],c=n[1],f=n[2],x=n[3],l=n[4],y=n[5],h=n[6],M=n[7],A=n[8],F=n[9],w=n[10],V=n[11],r[0]=s,r[1]=c,r[2]=f,r[3]=x,r[4]=l,r[5]=y,r[6]=h,r[7]=M,r[8]=A,r[9]=F,r[10]=w,r[11]=V,r[12]=s*e+l*i+A*a+n[12],r[13]=c*e+y*i+F*a+n[13],r[14]=f*e+h*i+w*a+n[14],r[15]=x*e+M*i+V*a+n[15]),r}function N(r,n,v){var e=v[0],i=v[1],a=v[2];return r[0]=n[0]*e,r[1]=n[1]*e,r[2]=n[2]*e,r[3]=n[3]*e,r[4]=n[4]*i,r[5]=n[5]*i,r[6]=n[6]*i,r[7]=n[7]*i,r[8]=n[8]*a,r[9]=n[9]*a,r[10]=n[10]*a,r[11]=n[11]*a,r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r}function O(r,n,v){var e=Math.sin(v),i=Math.cos(v),a=n[4],s=n[5],c=n[6],f=n[7],x=n[8],l=n[9],y=n[10],h=n[11];return n!==r&&(r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[4]=a*i+x*e,r[5]=s*i+l*e,r[6]=c*i+y*e,r[7]=f*i+h*e,r[8]=x*i-a*e,r[9]=l*i-s*e,r[10]=y*i-c*e,r[11]=h*i-f*e,r}function k(r,n,v){var e=Math.sin(v),i=Math.cos(v),a=n[0],s=n[1],c=n[2],f=n[3],x=n[8],l=n[9],y=n[10],h=n[11];return n!==r&&(r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=a*i-x*e,r[1]=s*i-l*e,r[2]=c*i-y*e,r[3]=f*i-h*e,r[8]=a*e+x*i,r[9]=s*e+l*i,r[10]=c*e+y*i,r[11]=f*e+h*i,r}function C(r,n,v){var e=Math.sin(v),i=Math.cos(v),a=n[0],s=n[1],c=n[2],f=n[3],x=n[4],l=n[5],y=n[6],h=n[7];return n!==r&&(r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=a*i+x*e,r[1]=s*i+l*e,r[2]=c*i+y*e,r[3]=f*i+h*e,r[4]=x*i-a*e,r[5]=l*i-s*e,r[6]=y*i-c*e,r[7]=h*i-f*e,r}function L(r,n,v,e,i){var a=1/Math.tan(n/2),s;return r[0]=a/v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(e-i),r[10]=(i+e)*s,r[14]=2*i*e*s):(r[10]=-1,r[14]=-2*e),r}var T=L;function X(r,n,v,e){var i,a,s,c,f,x,l,y,h,M,A=n[0],F=n[1],w=n[2],V=e[0],P=e[1],m=e[2],p=v[0],z=v[1],g=v[2];return Math.abs(A-p)<R&&Math.abs(F-z)<R&&Math.abs(w-g)<R?E(r):(l=A-p,y=F-z,h=w-g,M=1/Math.hypot(l,y,h),l*=M,y*=M,h*=M,i=P*h-m*y,a=m*l-V*h,s=V*y-P*l,M=Math.hypot(i,a,s),M?(M=1/M,i*=M,a*=M,s*=M):(i=0,a=0,s=0),c=y*s-h*a,f=h*i-l*s,x=l*a-y*i,M=Math.hypot(c,f,x),M?(M=1/M,c*=M,f*=M,x*=M):(c=0,f=0,x=0),r[0]=i,r[1]=c,r[2]=l,r[3]=0,r[4]=a,r[5]=f,r[6]=y,r[7]=0,r[8]=s,r[9]=x,r[10]=h,r[11]=0,r[12]=-(i*A+a*F+s*w),r[13]=-(c*A+f*F+x*w),r[14]=-(l*A+y*F+h*w),r[15]=1,r)}function Z(){var r=new j(3);return j!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function q(r,n,v){var e=new j(3);return e[0]=r,e[1]=n,e[2]=v,e}(function(){var r=Z();return function(n,v,e,i,a,s){var c,f;for(v||(v=3),e||(e=0),i?f=Math.min(i*v+e,n.length):f=n.length,c=e;c<f;c+=v)r[0]=n[c],r[1]=n[c+1],r[2]=n[c+2],a(r,r,s),n[c]=r[0],n[c+1]=r[1],n[c+2]=r[2];return n}})();function W(r,n,v,e){const i=_(n,v,e),a=G(r),s=I();return S(s,a,i),s}function _(r={x:0,y:0,z:0},n={x:0,y:0,z:0},v={x:1,y:1,z:1}){const e=I();return Y(e,e,q(r.x,r.y,r.z)),O(e,e,n.x),k(e,e,n.y),C(e,e,n.z),N(e,e,q(v.x,v.y,v.z)),e}const B=q(0,0,0),D=q(0,1,0);function G(r,n=60/180*Math.PI,v=.1,e=100,i={x:0,y:0,z:0}){const a=I(),s=q(i.x,i.y,i.z);Y(a,a,s),X(a,s,B,D);const c=I();return T(c,n,r,v,e),S(c,c,a),c}export{H as a,K as b,W as g,Q as p,U as u,J as v};
